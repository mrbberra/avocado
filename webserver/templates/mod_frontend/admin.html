{% extends 'base.html' %}

{% block script %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>

// @param: string
function getTweetView(buttonId) {
  var rows = $(".tweet-price-setter");
  rows.each(function( i ) {
      $(this).hide();
    });
  rows.each(function( i ) {
    switch (buttonId) {
      case ("button-default-view"):
        if ($(this).attr("data-price") == "-1.0") {
          $(this).show();
        }
        break;

      case ("button-all-view"):
        $(this).show();
        break;

      case ("button-price-adjusted-view"):
        if ($(this).attr("data-price") != "-1.0") {
          $(this).show();
        }
        break;

      case ("button-real-prices-view"):
        if ($(this).attr("data-price") != "-1.0" && $(this).attr("data-price") != "-2.0") {
          $(this).show();
        }
        break;
    }

  });
}

$(document).ready(function() {

  getTweetView("button-default-view");

  $(".view-choice-button").on('click', function() {
    getTweetView($(this).attr('id'));
  }
  );
});

</script>
{% endblock %}

{% block header %}
<h1>{% block title %}Admin{% endblock %}</h1>
{% endblock %}

{% block content %}
<div id="filter-options">
  <button class="view-choice-button" id="button-default-view">Show tweets that haven't been priced (default)</button>
  <button class="view-choice-button" id="button-all-view">Show all tweets</button>
  <button class="view-choice-button" id="button-price-adjusted-view">Show manually priced tweets</button>
  <button class="view-choice-button" id="button-real-prices-view">Show tweets with real prices</button>
</div>
{% for tweet in tweets %}
  <div class="tweet-price-setter" data-price="{{ tweet[2] }}">
    <div class="tweet">
      {% autoescape off %}
        {{ tweet[1] }}
      {% endautoescape %}
    </div>
    <div>
      <table style="width:50%">
        <tr>
          <th>Current Price: {{ tweet[2] }}</th>
          <th>
            <form method="post" action="/admin">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
              <input type="hidden" name="tweet_id" id="tweet_id" value="{{ tweet[0] }}"/>
              <input name="price" id="price" required>
              <input type="submit" value="Update Price">
            </form>
          </th>
        </tr>
      </table>
    </div>
  </div>
{% endfor %}
{% endblock %}
